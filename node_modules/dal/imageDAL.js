/**
 * Created with IntelliJ IDEA.
 * User: zmzsmnh
 * Date: 12-12-21
 * Time: 下午2:32
 * To change this template use File | Settings | File Templates.
 */

var collectionName = 'image';
var db = require('./mongo').db;
var dal = db.collection(collectionName);

db.bind(collectionName, {
    findAllAndsortByCreateTimePaging : function(fn) {
        dal.find({isPending: false}).sort({createTime: -1}).toArray(fn);
    },
    findAndsortByCreateTimePaging: function(query, fn) {
        query.isPending = false;
        dal.find(query).sort({createTime: -1}).toArray(fn);
    },
    findPageImagesSortByCreateTime: function(preId, limitNumber, fn) {
        dal.find({isPending: false, _id: {$lt: db.ObjectID(preId)}}).sort({createTime: -1}).limit(limitNumber).toArray(fn);
    },
    findFirstPageImagesSortByCreateTime: function(limitNumber, fn) {
        dal.find({isPending: false}).sort({createTime: -1}).limit(limitNumber).toArray(fn);
    }
});

exports.dal = dal;